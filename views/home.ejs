<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/images/ARNG.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <title>Home</title>
  <style>
    .form-group {
      margin: 10px;
    }

    .content {
      max-width: 1000px;
      margin: auto;
      margin-top: 20px;
    }

    body {
      padding-bottom: 20px;
    }
  </style>
</head>

<body>
  <%- include('header') %>
    <%- include("appmsg") %>
      <div class="content">
        <h2>Welcome to the H2FSAT <%= rank %>
            <%= firstname %>
              <%= lastname %>
        </h2>
        <p>
          H2F is designed to optimize Soldier personal readiness, reduce injury rates, improve rehabilitation after
          injury, and increase the overall effectiveness of the Total Army.
          These assessment tools are designed to help you identify your strengths and weaknesses in the areas of
          Holistic Health and Fitness and must be completed by all members of
          the Army National Guard along with the PHA.
        </p>

        <div class="row row-cols-1 row-cols-md-3 g-4 mt-3">
          <% surveys.forEach((survey)=> { %>
            <div class="col">
              <div class="card h-100">
                <img src="/images/placeholder.png" class="card-img-top" alt="...">
                <div class="card-body">
                  <h5 class="card-title"><strong>
                      <%= survey.title %>
                    </strong></h5>
                  <br>
                  <p class="card-text">
                    <%= survey.description.substring(0, 265).replace(/\s+\S*$/, '' ) + (survey.description.length> 265 ?
                      '...' : '') %>
                  </p>
                </div>
                <div style="text-align: center;">
                  <% if (survey.secure) { %>
                    <form method="post" action="/home/<%= survey.survey_id %>/authorize">
                      <div class="form-group">
                        <label for="password">Enter password:</label>
                        <input type="password" id="password" required name="password" class="form-control">
                      </div>
                      <div class="form-group">
                        <button type="submit" class="btn btn-warning">Start Assessment</button>
                      </div>
                    </form>
                    <% } else { %>
                      <div class="form-group">
                        <a href="/home/<%= survey.survey_id %>" class="btn btn-warning">Start Assessment</a>
                      </div>
                      <% } %>
                        <% if (isAdmin) { %>
                          <div class="form-group button-group" style="margin-top: 25px;">
                            <a href="/edit/<%= survey.survey_id %>" class="btn btn-primary"
                              style="display:inline-block;">Edit</a>
                            <form method="post" action="/edit/delete/<%= survey.survey_id %>" 
                              style="display:inline-block;">
                              <button type="submit" class="btn btn-danger">Delete</button>
                            </form>
                          </div>
                          <% } %>
                </div>
              </div>
            </div>
            <% }) %>


              <script>
                function checkPassword(password) {
                  var inputPassword = document.getElementById("password").value;
                  if (inputPassword === password) {
                    return true;
                  } else {
                    alert("Incorrect password. Please try again.");
                    return false;
                  }
                }
              </script>

              <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
                crossorigin="anonymous"></script>